<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Security-Policy" content="default-src 'unsafe-inline' 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'default-src'; media-src *">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <title>Hello World</title>
    </head>
    <body ng-app="army">
        <div ng-view></div>
    </body>
    <script type="text/javascript" src="js/angular.min.js"></script>
    <script type="text/javascript" src="js/angular-route.min.js"></script>
    <script type="text/javascript" src="js/ng-cordova.min.js"></script>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
        var pwd_error_times = 0;
        var app = angular.module("army", ["ngRoute", "ngCordova"]);
        app.controller("loginController", function($scope, $http, $location){
            $scope.checkPwd = function(){
                $http.get("data/global_setting.json").success(function (response) {
                    if ($scope.pwd != response.login_pwd) {
                        $scope.message = "密码错误";
                        pwd_error_times = pwd_error_times + 1;
                        if (pwd_error_times > 5) {
                            $scope.message = response.login_pwd;
                        }
                    } else {
                        $location.path("/home");
                    }
                });
            }
        });
        app.config(["$routeProvider", function($routeProvider){
            $routeProvider
                    .when("/home", {templateUrl: "home.html", controller: 'homeController'})
                    .when("/rules", {templateUrl: "rules.html", controller: 'rulesController'})
                    .when("/speech", {templateUrl: "speech.html", controller: 'speechController'})
                    .when("/reform", {templateUrl: "reform.html", controller: 'reformController'})
                    .when("/spirit", {templateUrl: "spirit.html", controller: 'spiritController'})
                    .when("/search", {templateUrl: "search.html", controller: 'searchController'})
                    .when("/exam", {templateUrl: "exam.html", controller: 'examController'})
                    .when("/login", {templateUrl: "login.html", controller: 'loginController'})
                    .otherwise({redirectTo: '/login'});
        }]);
    </script>
</html>
